<table mat-table [dataSource]="plans" class="mat-elevation-z8 plan-entry" multiTemplateDataRows>
    <ng-container matColumnDef="planDescription">
        <th mat-header-cell *matHeaderCellDef>การวัดผลเป้าหมาย</th>
        <td mat-cell *matCellDef="let element; let i = dataIndex" [attr.rowspan]="2" class="text-left"
            style="padding-left: 15px !important;">
            {{element.planDescription}}
        </td>
    </ng-container>
    <ng-container matColumnDef="planYear">
        <th mat-header-cell *matHeaderCellDef>ปี</th>
        <td mat-cell *matCellDef="let element" [attr.rowspan]="2">
            {{element.planYear}}
        </td>
    </ng-container>
    <ng-container matColumnDef="undertaker">
        <th mat-header-cell *matHeaderCellDef>ผู้รับผิดชอบ</th>
        <td mat-cell *matCellDef="let element" class="text-left" [attr.rowspan]="2">{{element.undertaker}}</td>
    </ng-container>
    <ng-container *ngFor="let col of months; let colIndex = index" [matColumnDef]="col">
        <th mat-header-cell *matHeaderCellDef>{{capitalizeFirstLetter(col)}}</th>
        <td mat-cell *matCellDef="let element; let i = dataIndex" class="text-month text-center bg-status-default cursor-pointer" [ngClass]="{
                'border border-solid border-white': col=='dec',
                'bg-reporting': document?.documentStatus === 'DOCUMENT_REPORTING',
                'bg-wait-for-verify': document?.documentStatus === 'DOCUMENT_WAIT_FOR_VERIFY',
                'bg-wait-for-approve': document?.documentStatus === 'DOCUMENT_WAIT_FOR_APPROVE',
                'bg-wait-for-release': document?.documentStatus === 'DOCUMENT_WAIT_FOR_RELEASE',
                'bg-released': document?.documentStatus === 'DOCUMENT_RELEASE',
                'italic': element['flowMonth' + (colIndex + 1)] === PlanFlow.VISITED
            }"
            (click)="openTargetEntryModal(element, col)"
            >
            <span class="text-month">P</span>
        </td>
    </ng-container>
    <ng-container matColumnDef="resultHeader">
        <td mat-cell *matCellDef="let element" [attr.colspan]="12"
            class="bg-slate-300 border border-solid border-white header-text">ทำได้จริง</td>
    </ng-container>
    <ng-container *ngFor="let col of planRow2" [matColumnDef]="col">
        <td mat-cell *matCellDef="let element; let i = dataIndex" class="text-center" [ngClass]="{ 
                'border border-solid border-white': col=='dec2'
            }">
        </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="planHeader"></tr>
    <tr mat-row class="example-element-row" *matRowDef="let element;let row;columns: planRow1"></tr>
    <tr mat-row class="example-element-row" *matRowDef="let element;let row;columns: planRow2"></tr>
</table>