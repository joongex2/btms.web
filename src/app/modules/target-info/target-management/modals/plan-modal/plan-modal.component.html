<div class="flex flex-col w-80v md:w-160 max-h-80v -m-6">

    <!-- Header -->
    <div class="flex flex-0 items-center justify-between h-16 pr-3 sm:pr-5 pl-6 sm:pl-8 bg-primary text-on-primary">
        <div class="text-lg font-medium text-white">
            <span *ngIf="!isEdit">เพิ่มการวัดผลเป้าหมาย</span>
            <span *ngIf="isEdit">แก้ไขการวัดผลเป้าหมาย</span>
        </div>
        <button mat-icon-button (click)="close()" [tabIndex]="-1">
            <mat-icon class="text-current text-white" [svgIcon]="'heroicons_outline:x'"></mat-icon>
        </button>
    </div>

    <!-- Compose form -->
    <form
        class="flex flex-col flex-auto p-6 sm:p-8 overflow-y-auto"
        [formGroup]="planForm">

        <!-- To -->
        <mat-form-field>
            <mat-label>ลำดับที่</mat-label>
            <input matInput [formControlName]="'priority'">
            <div class="copy-fields-toggles" matSuffix></div>
            <mat-error>ลำดับที่ is required</mat-error>
        </mat-form-field>

        <!-- Subject -->
        <mat-form-field class="fuse-mat-textarea flex-auto">
            <mat-label>การวัดผลเป้าหมาย</mat-label>
            <textarea matInput [formControlName]="'planDescription'" [rows]="5" matTextareaAutosize></textarea>
            <mat-error>การวัดผลเป้าหมาย is required</mat-error>
        </mat-form-field>

        <!-- <div class="flex flex-0 flex-col sm:flex-row sm:items-center sm:space-x-4 sm:justify-between"> -->
        <table class="year-month-table">
            <tr>
                <td class="row-1 flex items-center">
                    <div class="font-medium">ปี</div>
                    <mat-form-field class="gt-xs:pr-3 plan-year ml-2" style="width: 122px !important">
                        <mat-select [formControlName]="'planYear'">
                            <mat-option *ngFor="let year of years" [value]="year">{{year}}</mat-option>
                        </mat-select>
                        <mat-error>ปี is required</mat-error>
                    </mat-form-field>
                    <mat-checkbox class="ml-2" [color]="'primary'" [formControl]="checkAll">เลือกทุกเดือน</mat-checkbox>
                </td>
            </tr>
            <tr>
                <td class="row-2">
                    <div class="flex flex-wrap gap-[4px]">
                        <div class="month-box" *ngFor="let monthIndex of monthIndexes; let i = index">
                            <mat-checkbox  [color]="'primary'" [formControlName]="'useMonth' + monthIndex">{{capitalizeFirstLetter(monthShortMap[monthIndex])}}</mat-checkbox>
                        </div>
                    </div>
                </td>
            </tr>
        </table> 
            
        <!-- </div> -->

        <mat-form-field>
            <mat-label>ผู้รับผิดชอบ (ตำแหน่งงาน)</mat-label>
            <input matInput [formControlName]="'undertaker'">
            <div class="copy-fields-toggles" matSuffix></div>
            <mat-error>ผู้รับผิดชอบ (ตำแหน่งงาน) is required</mat-error>
        </mat-form-field>

        <!-- Alert -->
        <fuse-alert class="col-span-12" *ngIf="isShowError()" [appearance]="'outline'" [showIcon]="false" [type]="alert.type"
            [@shake]="alert.type === 'error'">
            {{alert.message}}
        </fuse-alert>

        <!-- Actions -->
        <div class="flex flex-col sm:flex-row sm:items-center justify-end mt-4 sm:mt-6">
            <div class="flex-none flex items-center cursor-pointer"
                (click)="saveAndClose()">
                <mat-icon svgIcon="heroicons_outline:check-circle"></mat-icon>&nbsp;<span>ตกลง</span>
            </div>
            <div class="flex-none sm:ml-2 flex items-center cursor-pointer"
                (click)="close()">
                <mat-icon svgIcon="heroicons_outline:x-circle"></mat-icon>&nbsp;<span>ยกเลิก</span>
            </div>
        </div>
    </form>
</div>
